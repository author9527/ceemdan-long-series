"""
CEEMDAN Long-Time-Series Extension - Standalone Monkey Patch

This script provides a standalone monkey-patch that can be applied to the
original emd-signal library to enable extraction of more than 8 IMFs.

Usage:
    from sift_patch import apply_patch
    apply_patch()
    
    # Then use emd.sift.complete_ensemble_sift normally
    import emd
    imfs = emd.sift.complete_ensemble_sift(data, max_imfs=15)

Author: [Your Name]
Date: 2026-01
License: GPL v2+
"""

import emd.sift as sift_module
from typing import Optional, Dict, Any


def apply_patch(aggressive_mode: bool = True) -> None:
    """
    Apply monkey patch to enable extended IMF extraction.
    
    Parameters
    ----------
    aggressive_mode : bool
        If True, use aggressive parameters (high energy_thresh, no rilling)
        to force extraction of max_imfs IMFs even for white noise.
        If False, only pass max_imfs to internal calls without aggressive parameters.
    
    Returns
    -------
    None
    """
    
    # Store original sift function
    original_sift = sift_module.sift
    
    def patched_sift(X, 
                     sift_thresh: float = 1e-8,
                     energy_thresh: float = 50,
                     rilling_thresh: Optional[tuple] = None,
                     max_imfs: Optional[int] = None,
                     verbose: Optional[str] = None,
                     return_residual: bool = True,
                     imf_opts: Optional[Dict[str, Any]] = None,
                     envelope_opts: Optional[Dict[str, Any]] = None,
                     extrema_opts: Optional[Dict[str, Any]] = None):
        """
        Patched sift function that respects max_imfs parameter more strictly.
        
        For long time-series analysis, we disable the energy threshold
        and rilling criteria to ensure all requested IMFs are extracted.
        """
        if aggressive_mode:
            # Use aggressive parameters to force complete extraction
            return original_sift(
                X,
                sift_thresh=sift_thresh,
                energy_thresh=1e10,  # Very high = never stop due to energy
                rilling_thresh=None,  # Disable rilling criterion
                max_imfs=max_imfs,
                verbose=verbose,
                return_residual=return_residual,
                imf_opts=imf_opts,
                envelope_opts=envelope_opts,
                extrema_opts=extrema_opts
            )
        else:
            # Use standard parameters but ensure max_imfs is respected
            return original_sift(
                X,
                sift_thresh=sift_thresh,
                energy_thresh=energy_thresh,
                rilling_thresh=rilling_thresh,
                max_imfs=max_imfs,
                verbose=verbose,
                return_residual=return_residual,
                imf_opts=imf_opts,
                envelope_opts=envelope_opts,
                extrema_opts=extrema_opts
            )
    
    # Apply the patch
    sift_module.sift = patched_sift
    
    print("CEEMDAN patch applied successfully!")
    print(f"  - aggressive_mode: {aggressive_mode}")
    print(f"  - Now using: emd.sift.complete_ensemble_sift(data, max_imfs=15+)")


def remove_patch() -> None:
    """
    Remove the monkey patch and restore original sift function.
    """
    if hasattr(sift_module, '_original_sift'):
        sift_module.sift = sift_module._original_sift
        print("Original sift function restored.")
    else:
        print("No patch to remove (original not saved).")


# Convenience function for quick setup
def setup_extended_ceemdan(aggressive_mode: bool = True):
    """
    Quick setup function to enable extended CEEMDAN analysis.
    
    Parameters
    ----------
    aggressive_mode : bool
        If True, use aggressive parameters for maximum IMF extraction.
    
    Example
    -------
    >>> from sift_patch import setup_extended_ceemdan
    >>> setup_extended_ceemdan()
    CEEMDAN patch applied successfully!
    >>> import emd
    >>> imfs = emd.sift.complete_ensemble_sift(data, max_imfs=15)
    """
    apply_patch(aggressive_mode=aggressive_mode)


# Example usage
if __name__ == "__main__":
    print("CEEMDAN Long-Time-Series Extension - Monkey Patch")
    print("=" * 50)
    print()
    print("To apply the patch:")
    print("  >>> from sift_patch import apply_patch")
    print("  >>> apply_patch()")
    print()
    print("Or use the quick setup:")
    print("  >>> from sift_patch import setup_extended_ceemdan")
    print("  >>> setup_extended_ceemdan()")
    print()
    print("Then use CEEMDAN normally with extended max_imfs:")
    print("  >>> import emd")
    print("  >>> imfs = emd.sift.complete_ensemble_sift(data, max_imfs=15)")
